<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>퀘스트 상세 • 로나월드</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif; }
  .card { border:1px solid #e5e7eb; border-radius:0.75rem; background:#fff; padding:1rem; }
  .muted { color:#6b7280; }
  .row { display:flex; align-items:center; gap:.75rem; }
  .grid { display:grid; gap:1rem; }
  img { max-width:100%; height:auto; }
  .thumb { width:56px; height:56px; object-fit:contain; background:#fff; border:1px solid #e5e7eb; border-radius:0.5rem; padding:4px; }
  .ibox { display:flex; align-items:center; gap:.75rem; padding:.5rem; border:1px solid #e5e7eb; border-radius:0.75rem; background:#fff; transition: background .15s ease; }
  .ibox:hover { background:#f9fafb; }
  .bubble{position:relative;max-width:80%;padding:.625rem .75rem;border-radius:1rem;line-height:1.45;box-shadow:0 1px 2px rgba(0,0,0,.06)}
  .bubble-left{background:#f8fafc;border:1px solid #e5e7eb;color:#111827}
  .bubble-right{background:#3b82f6;border:1px solid #1d4ed8;color:#fff}
  .bubble-left:after{content:"";position:absolute;left:-6px;top:12px;border-width:6px;border-style:solid;border-color:transparent #e5e7eb transparent transparent}
  .bubble-left:before{content:"";position:absolute;left:-5px;top:12px;border-width:6px;border-style:solid;border-color:transparent #f8fafc transparent transparent}
  .bubble-right:after{content:"";position:absolute;right:-6px;top:12px;border-width:6px;border-style:solid;border-color:transparent transparent transparent #1d4ed8}
  .bubble-right:before{content:"";position:absolute;right:-5px;top:12px;border-width:6px;border-style:solid;border-color:transparent transparent transparent #3b82f6}
  .bubble-name{font-weight:600;font-size:.875rem;margin-bottom:.125rem}
  .avatar{width:40px;height:40px;border-radius:9999px;border:1px solid #e5e7eb;object-fit:cover;background:#fff}
</style>
</head>
<body class="bg-gray-50 text-gray-900">
<div class="mx-auto max-w-5xl p-4 sm:p-6 lg:p-8">
<a class="inline-flex items-center gap-1 text-sm mb-4 text-blue-600 hover:underline" href="index.html?tab=quests" id="back-to-quests">← 퀘스트 목록으로</a>
<article id="detail"></article>
</div>
<script>
(()=>{
  'use strict';
  const q =
  {
  "id": "3703",
  "code": "팜 1-1",
  "title": "팜의 부탁",
  "type": "아이템 수집",
  "region": "리프레",
  "minLevel": 78,
  "start": {
    "npc": {
      "name": "팜",
      "img": "https://drive.google.com/thumbnail?id=1BftM7pIdpgFNuWkO5aYlcsmzRaSKRECG&sz=w200",
      "id": "2081004"
    },
    "place": {
      "name": "팜의 집",
      "img": "https://drive.google.com/thumbnail?id=17NNOW7-dgpJdPg1zTt1T5atFwL22oF6J&sz=w800",
      "code": "240000006"
    }
  },
  "finish": {
    "npc": {
      "name": "팜",
      "img": "https://drive.google.com/thumbnail?id=1BftM7pIdpgFNuWkO5aYlcsmzRaSKRECG&sz=w200",
      "id": "2081004"
    },
    "place": {
      "name": "팜의 집",
      "img": "https://drive.google.com/thumbnail?id=17NNOW7-dgpJdPg1zTt1T5atFwL22oF6J&sz=w800",
      "code": "240000006"
    }
  },
  "dialogues": [
    {
      "who": "팜",
      "text": "라라라~ 안녕하세요. 전 지금 제가 돌보는 알에게 자장가를 들려주고 있어요. 제가 노래를 불러주면 알이 편하게 잠들 수 있을 것 같아서요. 촌장님이 그러시는데 좋은 노래를 많이 들려주는 것이 좋대요."
    },
    {
      "who": "팜",
      "text": "전 노래뿐 아니라 알에게 좋은 악기연주도 들려주고 싶은데 마을에는 제가 다룰 수 있는 악기가 없어요. 숲에 사는 정령 헹키가 작은 팬플룻을 가지고 다닌다고 하던데 보신 적이 있나요? 그 팬 플룻을 모아서 커다란 플룻을 만들 수 있을 것 같은데 모아와 주시지 않겠어요?"
    },
    {
      "who": "팜",
      "text": "헹키가 가지고 다니는 팬플룻은 아주 작다고 들었어요. 그러니까 50개 정도만 있으면 제가 연주할 수 있는 팬 플룻을 만들 수 있지 않을까요?"
    }
  ],
  "completionDialogues": [
    {
      "who": "팜",
      "text": "감사합니다. 그것이 헹키가 가지고 다니던 팬 플룻이군요? 조금 어설프긴 하지만 조금만 손보면 좋은 플룻을 만들 수 있겠어요. 감사합니다."
    },
    {
      "who": "팜",
      "text": "알들을 위해서 플롯이 완성되는 대로 마을에서 가장 높은 나무 위에 올라가서 플룻을 연주할 거에요. 그때가 되면 꼭 제 연주를 들으러오셔야 해요~"
    }
  ],
  "descHtml": "<p>리프레 마을에서 알에게 노래를 불러주고 있는 팜을 만났다. 팜은 노래를 불러주는 것도 좋지만, 악기를 연주해 주고 싶다면서 커다란 플룻을 만들기 위해 미나르숲의 심술궂은 정령 헹키가 가지고 다니는 헹키의 팬플룻 50개를 모아다 달라고 했다.</p>",
  "reqs": [
    {
      "kind": "item",
      "name": "헹키의 팬플롯",
      "img": "https://drive.google.com/thumbnail?id=1Ehf759Xph7ucKNXWPD-Kd-xDdbjG8BMg&sz=w200",
      "qty": 50,
      "id": "4000231"
    }
  ],
  "tips": [
    {
      "kind": "monster",
      "name": "헹키",
      "level": 78,
      "img": "https://drive.google.com/thumbnail?id=1UM1GsJBTGKIWb-ZLBRG4Ly4stW_4ZWuM&sz=w200",
      "id": "2600002"
    }
  ],
  "rewards": [
    {
      "name": "신발 점프력 주문서 10% [랜덤]",
      "img": "https://drive.google.com/thumbnail?id=13PYrg8x28VFmCoxWQJYyqUXxozl9IDY5&sz=w200",
      "qty": 1,
      "itemId": "2040705"
    },
    {
      "name": "신발 점프력 주문서 60% [랜덤]",
      "img": "https://drive.google.com/thumbnail?id=1KhOKODVfNThiVBdxUqkoPM6xaY-vvEHi&sz=w200",
      "qty": 1,
      "itemId": "2040704"
    },
    {
      "exp": 308000,
      "img": "https://drive.google.com/thumbnail?id=1O9FuxyZEG_nZVJikWShUPKvb5zCH7t-z&sz=w200"
    }
  ],
  "prereqs": [],
  "nexts": []
};
  const img=(src,alt='',cls='')=>`<img src="${src||''}" alt="${alt||''}" ${cls?`class="${cls}"`:''} onerror="if(!this.dataset.fbk){this.dataset.fbk=1;this.src=this.src.replace('thumbnail?id=','uc?export=view&id=');}else{this.style.display='none'}">`;
  const row=(l,il,nl,r,ir,nr,ll='',lr='')=>{const cell=(label,im,name,link)=>{const inner=`${img(im,name)}<div class='text-sm'><div class='muted'>${label}</div><div class='font-medium'>${name||'-'}</div></div>`;return link?`<a class='row' href='${link}'>${inner}</a>`:`<div class='row'>${inner}</div>`;};return `<div class='row'>${cell(l,il,nl,ll)}<div class='muted' style='padding:0 .5rem'>|</div>${cell(r,ir,nr,lr)}</div>`;};
  const rewardBox=r=>{if(typeof r.exp==='number'){const pic=img(r.img,'EXP','thumb');const txt=`<div class='text-sm font-medium'>경험치 ${r.exp.toLocaleString()} exp</div>`;return `<div class='ibox'>${pic}${txt}</div>`;}const title=`${r.name||''}${(r.qty&&r.qty>0)?' ×'+r.qty:''}`;const pic=img(r.img,r.name,'thumb');const inner=`<div class='text-sm font-medium'>${title}</div>`;return r.itemId?`<a class='ibox' href='https://linsuol13-bit.github.io/LO/item-${r.itemId}.html'>${pic}${inner}</a>`:`<div class='ibox'>${pic}${inner}</div>`;};
  const reqBox=r=>{const isItem=r.kind==='item';const title=isItem?`${r.name} ×${r.qty||''}`:`${r.name} ×${r.qty||''}`;const pic=img(r.img,r.name,'thumb');const href = r.id ? (isItem ? `https://linsuol13-bit.github.io/LO/item-${r.id}.html` : `https://linsuol13-bit.github.io/LO/monster-${r.id}.html`) : '';const inner = `${pic}<div class='text-sm'><div class='muted'>${isItem?'필요 아이템':'처치 대상'}</div><div class='font-medium'>${title}</div></div>`;return href?`<a class='ibox' href='${href}'>${inner}</a>`:`<div class='ibox'>${inner}</div>`;};
  const isPlayer=w=>/^(나|플레이어|주인공|Player|영웅)$/i.test((w||'').toString().trim());
  const avatarFor=who=>{if(who===(q.start.npc&&q.start.npc.name))return q.start.npc.img;if(who===(q.finish.npc&&q.finish.npc.name))return q.finish.npc.img;return '';};
  const dialogueRow=d=>{d=d||{};const left=!isPlayer(d.who);const av=left?avatarFor(d.who):'';const avatar=(left&&av)?`<img class='avatar' src='${av}' alt='${d.who||''}' onerror="if(!this.dataset.fbk){this.dataset.fbk=1;this.src=this.src.replace('thumbnail?id=','uc?export=view&id=');}else{this.style.display='none'}">`:'';return `<div class='flex items-start ${left?'justify-start':'justify-end'} gap-2'>${left?avatar:''}<div class='bubble ${left?'bubble-left':'bubble-right'}'><div class='bubble-name'>${d.who||''}</div><div class='text-sm leading-snug' style='white-space:pre-line'>${d.text||''}</div></div></div>`;};
  const prereqSection=list=>{if(!Array.isArray(list)||!list.length)return'';const boxes=list.map(p=>`<a class='ibox' href='https://linsuol13-bit.github.io/LO/quest-${p.id}.html'><div class='text-sm'><div class='muted'>선행 퀘스트</div><div class='font-medium'>[${p.id}] ${p.title}</div></div></a>`).join('');return `<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>선행 퀘스트</h2><div class='grid'>${boxes}</div></section>`;};
  const nextSection=list=>{if(!Array.isArray(list)||!list.length)return'';const boxes=list.map(n=>`<a class='ibox' href='https://linsuol13-bit.github.io/LO/quest-${n.id}.html'><div class='text-sm'><div class='muted'>다음 퀘스트</div><div class='font-medium'>[${n.id}] ${n.title}</div></div></a>`).join('');return `<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>다음 퀘스트</h2><div class='grid'>${boxes}</div></section>`;};
  const reqSection=list=>{if(!Array.isArray(list)||!list.length)return'';return `<div class='mt-3'><div class='muted text-xs mb-1'>요구 조건</div><div class='grid' style='grid-template-columns:1fr 1fr; gap:.75rem'>${list.map(reqBox).join('')}</div></div>`;};
  const tipBox=t=>{ const pic=img(t.img,t.name,'thumb');
    const subtitle = t.kind==='monster' ? '몬스터 사냥' : (t.subtitle||'TIP');
    const title=`${t.name}`;
    const href = t.id ? (t.kind==='monster' ? `https://linsuol13-bit.github.io/LO/monster-${t.id}.html` : `https://linsuol13-bit.github.io/LO/item-${t.id}.html`) : '';
    const inner = `${pic}<div class='text-sm'><div class='muted'>${subtitle}</div><div class='font-medium'>${title}</div></div>`;
    return href?`<a class='ibox' href='${href}'>${inner}</a>`:`<div class='ibox'>${inner}</div>`;
  };
  const tipsSection=list=>{ if(!Array.isArray(list)||!list.length) return ''; return `<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>TIP</h2><div class='grid'>${list.map(tipBox).join('')}</div></section>`; };
  const $detail=document.getElementById('detail');
  $detail.innerHTML=`
    <header class='mb-4'><h1 class='text-2xl font-bold'>${q.code} · ${q.title}</h1><p class='text-sm muted'>${q.region} · ${q.type} · Lv.${q.minLevel}</p></header>
    ${prereqSection(q.prereqs)}
    <section class='grid' style='grid-template-columns:1fr 1fr;'>
      <div class='card'><h2 class='text-sm font-semibold mb-3'>시작</h2>${row('시작 NPC', q.start.npc.img, q.start.npc.name, '시작 장소', q.start.place.img, q.start.place.name, (q.start.npc.id?`https://linsuol13-bit.github.io/LO/npc-${q.start.npc.id}.html`:''), (q.start.place.code?`https://linsuol13-bit.github.io/LO/map-${q.start.place.code}.html`:''))}</div>
      <div class='card'><h2 class='text-sm font-semibold mb-3'>완료</h2>${row('완료 NPC', q.finish.npc.img, q.finish.npc.name, '완료 장소', q.finish.place.img, q.finish.place.name, (q.finish.npc.id?`https://linsuol13-bit.github.io/LO/npc-${q.finish.npc.id}.html`:''), (q.finish.place.code?`https://linsuol13-bit.github.io/LO/map-${q.finish.place.code}.html`:''))}</div>
    </section>
    <section class='mb-6'><h2 class='text-sm font-semibold mb-2'>대사</h2><div class='card' style='display:grid; gap:.5rem'>${(q.dialogues||[]).map(dialogueRow).join('')}</div></section>
    <section class='mb-6'><h2 class='text-sm font-semibold mb-2'>퀘스트 조건</h2><div class='card text-sm leading-relaxed text-gray-800 mb-3'>${q.descHtml}</div>${reqSection(q.reqs)}
      ${tipsSection(q.tips)}
      ${(q.completionDialogues&&q.completionDialogues.length)?`
      <div class='mt-4 pt-3 border-t'><h2 class='text-sm font-semibold mb-2'>완료 대사</h2><div class='card'>${(q.completionDialogues||[]).map(dialogueRow).join("")}</div></div>`:''}
    </section>
    ${(q.rewards&&q.rewards.length)?`<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>완료 보상</h2><div class='grid'>${q.rewards.map(rewardBox).join('')}</div></section>`:''}
    ${nextSection(q.nexts)}
  `;
})();
</script>
<script>
(function(){
  var a=document.getElementById('back-to-quests');
  if(!a) return;
  a.addEventListener('click',function(e){
    e.preventDefault();
    try{
      var href=this.getAttribute('href')||'index.html?tab=quests';
      var u=href+(href.indexOf('?')>-1?'&':'?')+'nocache='+Date.now();
      location.replace(u);
    }catch(err){ location.href='index.html?tab=quests'; }
  });
})();
</script>
</body>
</html>